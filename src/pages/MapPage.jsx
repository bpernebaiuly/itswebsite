import { useEffect, useState } from "react";
import "./MapPage.scss";
import Navbar from "@/components/shared/navbar/Navbar";
import Footer from "@/components/shared/footer/Footer";

const institutions = [
  {
    name: "Алматы қаласы әкімінің аппараты",
    address: "Алматы қ., Республика алаңы, 4",
    phone: "+7-727-271-65-44",
    coordinates: [43.236585, 76.945708],
  },
  {
    name: "\"Күнде\" әлеуметтік кафесі",
    address: "Астана қ., Қабанбай батыр даңғылы, 53",
    phone: "+7-777-022-69-59",
    coordinates: [51.090319, 71.398746],
  },
  {
    name: "Алматы қаласындағы психологиялық-медициналық-педагогикалық комиссиялар (ПМПК)",
    address: "Алматы қ., Ратушного, 131",
    phone: "+7-727-229-03-16",
    coordinates: [43.293660, 76.915875],
  },
  {
    name: "Алматы қаласындағы психологиялық-медициналық-педагогикалық комиссиялар (ПМПК)",
    address: "Алматы қ., Жароков, 18",
    phone: "+7-727-269-80-31",
    coordinates: [43.245451, 76.900154],
  },
  {
    name: "Алматы қаласындағы психологиялық-медициналық-педагогикалық комиссиялар (ПМПК)",
    address: "Алматы қ., Физули, 71",
    phone: "+7-727-257-08-55",
    coordinates: [43.330663, 76.975658],
  },
  {
    name: "Алматы қаласындағы психологиялық-медициналық-педагогикалық комиссиялар (ПМПК)",
    address: "Алматы қ., Федченко, 2Б",
    phone: "+7-727-399-97-39",
    coordinates: [43.250764, 76.845007],
  },
  {
    name: "Алматы қаласындағы психологиялық-медициналық-педагогикалық комиссиялар (ПМПК)",
    address: "Алматы қ., Жангелдин, 27",
    phone: "+7-727-397-41-55",
    coordinates: [43.256765, 76.801313],
  },
  {
    name: "Алматы қаласындағы психологиялық-медициналық-педагогикалық комиссиялар (ПМПК)",
    address: "Алматы обл., Талғар, Қонаев, 97/1",
    phone: "+7 (727) 295-60-39",
    coordinates: [43.301651, 77.230016],
  },
  {
    name: "Алматы қаласындағы психологиялық-медициналық-педагогикалық комиссиялар (ПМПК)",
    address: "Алматы қ., Досмұхамедов, 13",
    phone: "+7-727-393-66-74",
    coordinates: [43.173132, 76.791036],
  },
  {
    name: "Алматы қаласындағы психологиялық-медициналық-педагогикалық комиссиялар (ПМПК)",
    address: "Алматы қ., 8-ші ықшам ауданы, 46",
    phone: "+7-727-249-10-65",
    coordinates: [43.225491, 76.868758],
  },
  {
    name: "Алматы қаласындағы психологиялық-медициналық-педагогикалық комиссиялар (ПМПК)",
    address: "Алматы қ., Шұғыла ықшам ауданы, 340Б",
    phone: "+7-727-351-79-57",
    coordinates: [43.205353, 76.787173],
  },
  {
    name: "Алматы қаласындағы психологиялық-медициналық-педагогикалық комиссиялар (ПМПК)",
    address: "Алматы қ., Әбіш Кекілбайұлы, 88",
    phone: "+7-727-376-58-29",
    coordinates: [43.216891, 76.888889],
  },
  {
    name: "Алматы саулық және денсаулық қоғамының сауықтыру орталығы",
    address: "Алматы қ., Ақан Сері, 36",
    phone: "+7-701-712-12-55",
    coordinates: [43.326820, 76.950738],
  },
  {
    name: "Teen Chellenge Kazakhstan, оңалту орталығы",
    address: "Алматы қ., Есенов, 53",
    phone: "+7-727-256-22-96",
    coordinates: [43.271477, 76.953649],
  },
  {
    name: "Асыл Мирас, оңалту орталығы",
    address: "Астана қ., Каркабат, 13",
    phone: "+7-7172-49-80-00",
    coordinates: [51.136125, 71.472659],
  },
  {
    name: "SpineClinic, медицина орталығы",
    address: "Астана қ., Генерал Сабыр Рақымов, 36",
    phone: "+7-707-577-00-20",
    coordinates: [51.164607, 71.438352],
  },
  {
    name: "Тамам, доктор Бубновскийдің орталығы",
    address: "Қарағанды қ., Гастелло, 13",
    phone: "+7-7212-56-94-94",
    coordinates: [49.818793, 73.116513],
  },
  {
    name: "Тамам, доктор Бубновскийдің орталығы",
    address: "Қарағанды қ., Республика даңғылы, 13",
    phone: "+7-7212-56-94-94",
    coordinates: [49.790892, 73.136177],
  },
  {
    name: "Валеокинеза, Академия",
    address: "Астана қ., Сарайшық, 36",
    phone: "+7-7172-51-39-70",
    coordinates: [51.132757, 71.435271],
  },
  {
    name: "Жандаурен, Хоспис",
    address: "Өскемен қ., Вострецов, 9/1",
    phone: "+7-7232-50-28-52",
    coordinates: [50.009098, 82.566610],
  },
  {
    name: "Үміт, Реабилитационный центр детей-инвалидов с церебральным параличом",
    address: "Қарағанды қ., Кривогуз, 96",
    phone: "+7-7212-43-83-03",
    coordinates: [49.798545, 73.066899],
  },
  {
    name: "Өскемен облыстық хосписі",
    address: "Өскемен қ., Космическая, 19",
    phone: "+7-7232-75-93-34",
    coordinates: [49.963909, 82.609172],
  },
  {
    name: "Гиппократ, көпсалалы медицина орталығы",
    address: "Қарағанды қ., Алиханов, 35/2",
    phone: "+7-7212-49-33-77",
    coordinates: [49.813387, 73.104116],
  },
  {
    name: "Гиппократ, көпсалалы медицина орталығы",
    address: "Қарағанды қ., Ерубаев, 8",
    phone: "+7-7212-92-29-50",
    coordinates: [49.818549, 73.084165],
  },
  {
    name: "Гиппократ, көпсалалы медицина орталығы",
    address: "Қарағанды қ., Кривогуз, 10",
    phone: "+7-7212-49-37-08",
    coordinates: [49.805871, 73.069666],
  },
  {
    name: "Мүгедек балалардың ата-аналарының қауымдастығы, Оңалту орталығы",
    address: "Алматы қ., Құрманғазы, 120",
    phone: "+7-7272-92-48-99",
    coordinates: [43.242542, 76.921103],
  },
];


const MapPage = () => {
  const [yMap, setYMap] = useState(null);

  useEffect(() => {
    if (window.ymaps) {
      window.ymaps.ready(() => {
        const map = new window.ymaps.Map("yandex-map", {
          center: [43.2447, 76.9052],
          zoom: 14,
        });

        setYMap(map);
      });
    }
  }, []);

  const handleSelect = (item) => {
    if (!yMap) return;

    const placemark = new window.ymaps.Placemark(item.coordinates, {
      balloonContent: `<strong>${item.name}</strong><br/>${item.address}`,
    });

    yMap.geoObjects.removeAll();
    yMap.geoObjects.add(placemark);
    yMap.setCenter(item.coordinates, 16);
  };

  return (
    <>
      <Navbar />
      <div className="map-page">
        <div className="map-container">
          <div className="sidebar">
            {institutions.map((item, i) => (
              <div key={i} className="institution-card" onClick={() => handleSelect(item)}>
                <h3>{item.name}</h3>
                <p>{item.address}</p>
                <p>{item.phone}</p>
              </div>
            ))}
          </div>
          <div className="map">
            <div id="yandex-map" />
          </div>
        </div>
      </div>
      <Footer />
    </>
  );
};

export default MapPage;
